package lift;

public class Person extends Thread {
	private int currentFloor;
	private int targetFloor;
	private Monitor monitor;
	private boolean inElevator;

	public Person(Monitor monitor) {
		super();
		inElevator = false;
		this.monitor = monitor;
		currentFloor = (int) Math.random() * 7;
		targetFloor = nextFloor();
		monitor.enteredFloor(currentFloor);
	}

	public void run() {
		while (true) {
			if (monitor.canEnter(currentFloor)) {
				monitor.enterLift(targetFloor);
				inElevator = true;
			} else if (inElevator && monitor.getCurrentFloor() == targetFloor) {
				monitor.exitLift();
			}
		}
	}

	private int nextFloor() {
		int n = (int) Math.random() * 7;
		while (n == currentFloor) {
			n = (int) Math.random() * 7;
		}
		return n;
	}
}
